<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>Task Management</title>
  <style>
    body {
      font-family: Arial;
      padding: 20px;
      background: #fff8f0;
    }
    h2 { color: #ff8c3a; }
    .task-box {
      background: white;
      padding: 15px;
      margin-bottom: 12px;
      border-radius: 8px;
      border: 1px solid #ddd;
    }
    button {
      background: #ff8c3a;
      color: white;
      padding: 6px 12px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      margin-right: 6px;
    }
    button:hover {
      background: #e6782f;
    }
  </style>
</head>
<body>

<h2>ğŸ—‚ Task Management â€” è€å¸ˆä»»åŠ¡ç®¡ç†</h2>
<p>ä½ å¯ä»¥ç»™å­¦ç”Ÿå¸ƒç½®ä»»åŠ¡ï¼š</p>

<div id="taskList">åŠ è½½ä¸­...</div>

<script>
const API = "https://lingualisten-backend.onrender.com";

// è½½å…¥ä»»åŠ¡åˆ—è¡¨
async function loadTasks() {
  const res = await fetch(API + "/tasks/1");  // ä½ ç›®å‰åªæœ‰ä¸€ä¸ªä»»åŠ¡ï¼Œæ‰€ä»¥æš‚æ—¶å›ºå®š 1
  const task = await res.json();

  const div = document.getElementById("taskList");
  div.innerHTML = `
    <div class="task-box">
      <h3>ä»»åŠ¡ï¼š${task.title}</h3>
      <p>æ¨¡å¼ï¼š${task.modes.join(", ")}</p>
      <button onclick="assignTask(${task.id})">ğŸ“¤ å¸ƒç½®ä»»åŠ¡ç»™å­¦ç”Ÿ</button>
    </div>
  `;
}

// å¸ƒç½®ä»»åŠ¡ç»™æŸä¸ªå­¦ç”Ÿ
async function assignTask(taskId) {
  let username = prompt("è¯·è¾“å…¥å­¦ç”Ÿç”¨æˆ·åï¼š");
  if (!username) return;

  const data = {
    username: username,
    task_id: taskId
  };

  let res = await fetch(API + "/assign", {
    method: "POST",
    headers: {"Content-Type": "application/json"},
    body: JSON.stringify(data)
  });

  if (res.ok) {
    alert("ä»»åŠ¡å·²æˆåŠŸåˆ†é…ç»™ï¼š" + username);
  } else {
    alert("åˆ†é…å¤±è´¥ï¼Œè¯·æ£€æŸ¥å­¦ç”Ÿç”¨æˆ·åæ˜¯å¦å­˜åœ¨");
  }
}

loadTasks();
</script>

</body>
</html>
