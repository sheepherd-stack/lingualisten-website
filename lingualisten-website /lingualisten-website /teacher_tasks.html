<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>Teacher Tasks Â· LinguaListen</title>
<style>
  body { font-family: Arial; padding:20px; background:#fff5eb; }
  h2 { color:#ff7e2b; }

  .box {
    background:white; padding:15px;
    border-radius:12px;
    border:2px solid #ff7e2b;
    max-width:500px; margin-bottom:25px;
  }

  input, select {
    width:90%; padding:10px;
    border-radius:8px;
    border:1px solid #ccc;
    margin-top:5px;
  }

  button {
    padding:12px; background:#ff7e2b; color:white;
    font-size:16px; border:none; border-radius:8px;
    margin-top:10px; cursor:pointer;
  }
  button:hover { background:#ff9c57; }

  .task-item { border-bottom:1px solid #ddd; padding:10px 0; }
</style>
</head>
<body>

<h2>ğŸ“˜ Teacher Tasks ç®¡ç†ä»»åŠ¡</h2>

<!-- Create Task -->
<div class="box">
  <h3>â• Create Task åˆ›å»ºä»»åŠ¡</h3>

  <label>Title æ ‡é¢˜ï¼š</label>
  <input id="task_title">

  <label>Material IDï¼ˆææ–™ç¼–å·ï¼‰ï¼š</label>
  <input id="material_id" placeholder="ä¾‹å¦‚ï¼š1">

  <label>Modes æ¨¡å¼ï¼š</label>
  <select id="task_modes" multiple size="4">
    <option value="dictation">Dictation å¬å†™</option>
    <option value="shadowing">Shadowing è·Ÿè¯»</option>
    <option value="retell">Retell å¤è¿°</option>
    <option value="summary">Summary æ‘˜è¦</option>
  </select>

  <label>Difficulty éš¾åº¦ï¼š</label>
  <select id="task_difficulty">
    <option value="easy">Easy ç®€å•</option>
    <option value="medium">Medium ä¸­ç­‰</option>
    <option value="hard">Hard å›°éš¾</option>
  </select>

  <button onclick="createTask()">Create æäº¤</button>
  <p id="create_result"></p>
</div>

<!-- Task List -->
<div class="box">
  <h3>ğŸ“„ All Tasks å…¨éƒ¨ä»»åŠ¡</h3>
  <div id="task_list">Loading...</div>
</div>

<script>
const API = "https://lingualisten-backend.onrender.com";

// Load all tasks
async function loadTasks() {
  const res = await fetch(API + "/tasks_list");
  const tasks = await res.json();

  const box = document.getElementById("task_list");
  box.innerHTML = "";

  tasks.forEach(t => {
    const item = document.createElement("div");
    item.className = "task-item";

    item.innerHTML = `
      <b>${t.title}</b> (ID: ${t.id})<br>
      Material: ${t.material_id}<br>
      Modes: ${t.modes.join(", ")}<br>
      Difficulty: ${t.difficulty}<br>
    `;

    box.appendChild(item);
  });
}

// Create Task
async function createTask() {
  const title = document.getElementById("task_title").value;
  const material_id = Number(document.getElementById("material_id").value);

  const selected = Array.from(document.getElementById("task_modes").selectedOptions)
                        .map(o => o.value);

  const difficulty = document.getElementById("task_difficulty").value;

  const payload = {
    title,
    material_id,
    modes: selected,
    difficulty
  };

  const res = await fetch(API + "/tasks", {
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body: JSON.stringify(payload)
  });

  const text = await res.text();
  document.getElementById("create_result").innerHTML = text;

  loadTasks();
}

// åˆå§‹åŠ è½½ä»»åŠ¡åˆ—è¡¨
loadTasks();
</script>

</body>
</html>
